#!/bin/sh

  _TITLE_="Puppy_run-pureftpd"
_VERSION_=1.0omega
_COMMENT_="$_TITLE_:Puppy Linux shell script [to TODO here]"

MY_SELF="$0"
MY_PID=$$

test -f /etc/rc.d/f4puppy5 && {
 set +e
 source /etc/rc.d/f4puppy5 && {
 set +n
 source /etc/rc.d/f4puppy5; } || echo "WARNING : Could not source /etc/rc.d/f4puyppy5 ."

ADD_PARAMETER_LIST=
ADD_PARAMETERS=
_provide_basic_parameters

ADD_HELP_MSG="$_COMMENT_"
_parse_basic_parameters "$@"
[ "$DO_SHIFT" ] && [ ! "${DO_SHIFT//[[:digit:]]/}" ] && {
for i in `seq 1 1 $DO_SHIFT`; do shift; done; }

_trap
} || echo "Warning : No /etc/rc.d/f4puppy5 installed."

#Add to /etc/rc.d/rc.local for auto startup: pure-ftpd -EbBADHk 90
if [ "$(ps | grep $(cat /var/run/pure-ftpd.pid) | grep pure-ftpd)" != "" ] ; then

Xdialog --wmclass "pure-ftpd" --title "Start/Stop PureFTPD" --stdout --ok-label "Stop Server" --cancel-label "Cancel" --yesno "Pure-FTPD is running. \n Would you like to stop the server?" 0 0

 if  [ "$?" = "1" ] ;then
 exit
 fi
 kill -9 $(cat /var/run/pure-ftpd.pid)
 exit
fi
vMsgH=15 ; vMsg=''
        vMsgW=40
        cfg=`Xdialog --title "$vServerTitle Start/Stop Pure-FTPD." \
                        --backtitle "Pure-ftpd is currently not Running." \
                        --left --separator \  \
                        --ok-label "Start Pure-ftpd" \
                        --checklist " " \
                15 85 4 \
                '-u 1' "Prevent user root connections." off \
                '-E' "Prevent anonymous connections." on \
                2>&1 || echo .`
        [ "$cfg" == "." ] && exit

pure-ftpd -bBADHk 90 $cfg

Xdialog --wmclass "pure-ftpd" --title "Start/Stop PureFTPD" --stdout --ok-label "OK" --infobox "Pure-ftpd is started. \n If you allowed anonymous connections, web browsers will connect as user ftp. \n User ftp's home directory is at /root/ftpd. \n If you allowed root logins you should set a root password. \n To set a password for root, open a terminal and type passwd. \n To stop the server run this script again." 0 0 90000


# Very End of this file 'usr/sbin/run-pureftpd' #
###END###

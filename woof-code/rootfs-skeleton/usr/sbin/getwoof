#!/bin/ash
#120801 download Woof.
#this code is clumsy, had to checkout, then set some parameters in repo, then erase and checkout again.
. /etc/rc.d/f4puppy5
# BATCHMARKER01 - Marker for Line-Position to bulk insert code into.
#One optional parameter, 'update'.

git="$(which git)"

if [ $1 ];then
 case $1 in
  *update)
   [ "$git" ]   || _exit 1 "Please install git."
   [ -d woofx ] || _exit 2 "Directory woofx does not exist in current directory."
   cd woofx     || _exit 4 "Could not change into woofx directory."
   git status   || _exit 8 "Please cleanup first."
   git pull
  ;;
  *help)
   echo "Current directory must be in a Linux filesystem."
   echo "The Woof repository will be checked-out into directory 'woofx'."
   echo "Option passed parameter 'update' will update 'woofx' from the online
Woof repository directory."
  ;;
 esac
 exit 0
fi

# download woof-CE's code
if [ -n "$git" ]
then
	"$git" clone https://github.com/puppylinux-woof-CE/woof-CE.git woofx
else
	zip="$(mktemp -u)" || _exit 32 "Could not create tmp dir."
	wget -O "$zip" https://github.com/puppylinux-woof-CE/woof-CE/archive/master.zip || _exit 64 "Could not download."
	unzip "$zip" || _exit 128 "Could not unzip."
	[ "$DEBUG" ] || rm $VERB -f "$zip"
	mv $VERB woof-CE-master woofx
fi

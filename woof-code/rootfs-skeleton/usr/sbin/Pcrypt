#! /bin/bash

# Pcrypt created by coolpup for Puppy Linux
# Pcrypt is based on bcrypt which uses Blowfish encryption
# February 2009 GPL v3 License

  _TITLE_=Puppy_Crypt
_VERSION_=1.0omega
_COMMENT_="GTKdialog GUI for bcrypt"

MY_SELF="$0"
MY_PID=$$

test -f /etc/rc.d/f4puppy5 && {
[ "$HAVE_F4PUPPY5" ] || . /etc/rc.d/f4puppy5

ADD_PARAMETER_LIST=""
ADD_PARAMETERS=""
_provide_basic_parameters

TWO_HELP=''; TWO_VERSION=''; TWO_VERBOSE=''; TWO_DEBUG=''; ## Set to anything if code requires further down (ie. custom usage or version message)
ADD_HELP_MSG="$_COMMENT_"
_parse_basic_parameters "$@"
[ "$DO_SHIFT" ] && [ ! "${DO_SHIFT//[[:digit:]]/}" ] && {
  for oneSHIFT in `seq 1 1 $DO_SHIFT`; do shift; done; }

_trap
}

cd $HOME

export Pcrypt='
<window title="Pcrypt - file encryption & secure deletion">
<vbox>
  <hbox>
  <text><label>For file encryption or decryption: drag the file here â†“                </label></text>
  </hbox>
  <hbox>
  <entry accept="directory"><variable>SOURCE</variable></entry>
  </hbox>
  <hbox>
   <text>
    <label>For secure deletion: first encypt, then delete, then forget          </label>
   </text>
  </hbox>
  <hbox>
  <button help>
   <action>`Xdialog --wrap --screencenter --left --title "Pcrypt - HELP" --msgbox "Pcrypt is designed to be the simplest possible graphical user interface to bcrypt. Bcrypt is a cross-platform file encryption utility which means that encrypted files are portable across all supported operating systems and processors, of which Linux and Win32 are two of them.\n\nIt is used for encrypting files, and can be used for secure deletion, which is better than any common file shredder since the deleted file has been encrypted beforehand. It is available from the main menu and from the right-click context menu by default for most of the basic text, image, and audio file types.\n\nPassphrases must be between 8 and 56 characters and are hashed internally to a 448 bit key (the largest keysize supported by the blowfish algorithm) regardless of the passphrase size. However, all characters supplied are significant since the stronger your passphrase, the more secure your data will be. WARNING: If you forget the encryption key (passphrase) your file can never be opened again in your lifetime and probably never will.\n\nBy default, bcrypt will compress input files before encryption, remove input files after they are processed (assuming they are processed successfully), and overwrite the original input files with random data three times before deleting them in order to prevent data recovery by unauthorized persons.\n\nEncrypted files will be saved with an extension of .bfe. Any files ending in .bfe will be assumed to be encrypted with bcrypt, and so bcrypt will attempt to decrypt them. Any other input files will be encrypted.\n\nBcrypt uses the blowfish encryption algorithm published by Bruce Schneier in 1993.\n\nPcrypt was created by coolpup for Puppy Linux, February 2009 GPL v3 Licence.\n\nBcrypt copyright (c) 2002 Johnny Shelley All rights reserved. Licence supplied." 600x0`</action>
  </button>
  <button cancel></button>
  <button ok></button>
  </hbox>
</vbox>
</window>'

I=$IFS; IFS=""
for STATEMENTS in  $(gtkdialog3 --program=Pcrypt --center); do
   eval $STATEMENTS
done
IFS=$I
if [ $EXIT = OK ]; then
  rxvt -name bcrypt -e bcrypt $SOURCE
fi
# Very End of this file 'usr/sbin/Pcrypt' #
###END###

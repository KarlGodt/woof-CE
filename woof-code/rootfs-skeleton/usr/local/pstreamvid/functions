#!/bin/sh
#pstreamvid
#Trio Tjandradjaja- GPL 2009

case "$1" in

-off)
	killall gxine &
	;;
-offmplayer)
	killall mplayer &
	;;
-apply)
   if [ ! "$CHANNEL" ]; then
   xmessage -center -bg orange -default exit "Please choose available Channel" ; exit 0
   else
   NEWCHANNEL=`cat /usr/local/pstreamvid/channels/$CHANNEL`
   Xdialog --infobox "Starting gXine..please wait\n\n\nTrio Tjandradjaja - 2009" 12 40 &
      if [ "$OFF" = "true" ] ; then
      killall gxine
      exec gxine --geometry 512x288+0+0 "$NEWCHANNEL"
      else
      killall gxine
      exec gxine -fS "$NEWCHANNEL"
      fi
   fi
      ;;
-applymplayer)
   if [ ! "$CHANNEL" ]; then
   xmessage -center -bg orange -default exit "Please choose available Channel" ; exit 0
   else
   [ ! "`which mplayer`" ] && xmessage -center -bg orange -default exit "Please Install Mplayer First" && exit 0
   NEWCHANNEL=`cat /usr/local/pstreamvid/channels/$CHANNEL`
   Xdialog --infobox "Starting Mplayer..please wait\n\n\nTrio Tjandradjaja - 2009" 12 40 &
      if [ "$OFF" = "true" ] ; then
      killall mplayer
      exec mplayer -geometry +0+0 "$NEWCHANNEL"
      else
      killall mplayer
      exec mplayer -fs "$NEWCHANNEL"
      fi
   fi
   ;;
-add_channel)
	if [ "$URL" = 'Please copy & paste URL' ]; then
		xmessage -center -bg orange -default exit "Please copy & paste new URL" ; exit
	else

		echo "$URL" > /usr/local/pstreamvid/channels/"$NAME"
		ls -1 /usr/local/pstreamvid/channels/ | awk '{print $1}' > /usr/local/pstreamvid/tmp/channels
	fi
	;;
-remove)
	if [ ! "$CHANNEL" ]; then
		xmessage -center -bg orange -default exit "Please choose Channel to be removed" ; exit
	else
		rm /usr/local/pstreamvid/channels/$CHANNEL
		ls -1 /usr/local/pstreamvid/channels/ | awk '{print $1}' > /usr/local/pstreamvid/tmp/channels
	fi
	;;

esac

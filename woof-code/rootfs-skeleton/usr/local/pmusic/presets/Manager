#!/bin/bash

#####$APPDIR/func -update_playlist & #playlist is refreshed later, so it should be safe to run in background
. $APPDIR/func -show_add_window -auto
. $APPDIR/gui_add
. $APPDIR/gui_misc
. $APPDIR/gui_menu
. $APPDIR/gui_toolbar
. $APPDIR/gui_playlist
. $APPDIR/gui_navigation
. $APPDIR/gui_mixer
$APPDIR/func -update_index_check

GUI='
<window title="Pmusic" icon-name="gtk-media-stop" default_height="'$HEIGHT'" default_width="'$WIDTH'">
 <vbox>
  '$GUI_MENU'


   <hbox scrollable="true" height="200" width-request="10"> ##width-request to avoid scrollbars
    <vbox space-expand="true" space-fill="true">
     <vbox space-expand="false" space-fill="false">
      <text height-request="2"><label>""</label></text>
      '$GUI_ADD_SEARCH'
     </vbox>
     <hbox space-expand="true" space-fill="true">
      '$GUI_ADD_FIELD'
     </hbox>
    </vbox>
    <vbox width-request="350">
    '$GUI_PLAYLIST_FIELD'
    </vbox>
   </hbox>

  <hbox height-request="90" spacing="0">
   <hbox spacing="0" space-expand="false" space-fill="false">
    <button relief="2" tooltip-text="'$LOC131'">
     <variable>ARTWORK</variable>
     <input file>'$HOME'/.pmusic/nowplaying_albumart.jpg</input>
     <width>80</width>
     <action>'$APPDIR'/func_trackinfo -showtab_albumart &</action>
    </button>
   </hbox>

   <vbox space-expand="true" space-fill="true">
    '$GUI_ADD_PROGRESS'
    <hbox>
     <hbox space-expand="false" space-fill="false">
      '$GUI_NAVIGATION'
     </hbox>
     <hbox space-expand="true" space-fill="true">
      <text><label>""</label></text>
     </hbox>
     '$GUI_BUTTON_MUTE'
     <vseparator></vseparator>
     '"$GUI_BUTTON_OVERVIEW
     <vseparator></vseparator>
     $GUI_BUTTON_PLAYLIST_HISTORY_BACK
     $GUI_BUTTON_PLAYLIST_HISTORY_FORWARD
     $GUI_BUTTON_NEW
     <vseparator></vseparator>
     $GUI_BUTTON_PREFERENCES
     $GUI_BUTTON_CD
     $GUI_BUTTON_SONG_INFO
     <vseparator></vseparator>
     $GUI_BUTTON_PLAYMODE
     $GUI_BUTTON_ADDMODE
     <text width-request=\"3\"><label>\"\"</label></text>
     $GUI_MIXER
    </hbox>
    $GUI_PROGRESSBAR"'
    '$GUI_PROGRESS'
    '$GUI_STATUSBAR'
   </vbox>
   </hbox>


 </vbox>
 <action signal="hide">$APPDIR/func_config -write_config</action>
 <action signal="hide">exit:Exit</action>
</window>'

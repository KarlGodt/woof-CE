#!/bin/sh
cd /tmp
grep -v password $PJCFG > $PJTMP/pjsua.cfg
cat $PJTMP/pjsua.cfg
USER="$(cat $PJTMP/pjsua.cfg | grep username | sed 's/--username//;s/ //g')"
echo "About to compile PSIP crash report"
echo "This will contain IP addresses, account names and IM messages but no passwords"
echo "The information above from your config file will be included in the report."
echo "Please make sure it does not contain passwords or other information you do not want to send."
echo "When you press enter the report will be saved in a tar.gz file in /tmp"
read a
cp -r psip "psip-crash-$USER-$(date +%y-%m-%d-%H-%M-%S)"
tar -cvzf "psip-crash-$USER-$(date +%y-%m-%d-%H-%M-%S).tar.gz" "psip-crash-$USER-$(date +%y-%m-%d-%H-%M-%S)"
echo
echo "Crash report saved in /tmp now you can email it to Will"
echo "It would probably be sensible to stop and then start pjsua before trying to use it again."
echo "Hit return to close this window and open /tmp"
read a
rox /tmp
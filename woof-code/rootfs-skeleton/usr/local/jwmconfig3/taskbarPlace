#!/bin/bash
#
# Code adapted for Puppy 1.0.9, JWM 1.7
# by Kwiller on 6-May-2006
#
###################

##-----taskbarPlace----->>
PRO="taskbarPlace"
SCRIPT_DIR="/usr/local/jwmconfig3"
. "$SCRIPT_DIR/path"
. /etc/rc.d/f4puppy5

#-----Backup current settings----->>
. "$SCRIPT_DIR/func" -backup2

#----Set defaults---->>
AT_BTM=ON
AT_TOP=off

#----Are current settings non-default---->>
SET_TOP=`grep -c "y=\"$TOP\"" "$trayFILE"`

if [ "$SET_TOP" -eq "1" ]; then
    AT_BTM=off
    AT_TOP=ON
fi
SEDTOP=s!y=\"$BTM\"!y=\"$TOP\"!g
SEDBTM=s!y=\"$TOP\"!y=\"$BTM\"!g
##---end defaults--->

#-------------gui----------->>

Xdialog --backtitle "JWM Taskbar Configuration" \
    --title "Taskbar" \
        --radiolist "Choose a tray placement option" 13 46 2 \
"BOTTOM"  "Tray at Bottom of Screen." $AT_BTM \
"TOP"  "Tray at Top of Screen" $AT_TOP 2>"$tmpCL"

retval=$?

#--------cancel pressed----->>
. "$SCRIPT_DIR/func" -cancel

#---------save changes----->>

POSN=`cat "$tmpCL"`

#-----If there new settings chosen then make the changes----->>
if [ "$POSN" = "TOP" ]; then
  if [ "$SET_TOP" -eq "0" ]; then
    sed -e "$SEDTOP" "$trayFILE" >"$trayFILEtmp"
    SED_RV=$?
    mv "$trayFILEtmp" "$trayFILE"
  fi
else
  if [ "$SET_TOP" -eq "1" ]; then
    sed -e "$SEDBTM" "$trayFILE" >"$trayFILEtmp"
    SED_RV=$?
    mv "$trayFILEtmp" "$trayFILE"
  fi
fi

#------check new configuration----->>
. "$SCRIPT_DIR/func" -cancel

#----notify of result----->>
if [ "$POSN" = "TOP" ]; then
  RES=`grep -c "y=\"$TOP\"" "$trayFILE"`
else
  RES=`grep -c "y=\"$BTM\"" "$trayFILE"`
fi
CHOICE=$POSN
PATTERN="of the Screen"
PF=0

. "$SCRIPT_DIR/func" -notify

#--------clean exit------->>
rm -f "$tmpCL"
exit 0

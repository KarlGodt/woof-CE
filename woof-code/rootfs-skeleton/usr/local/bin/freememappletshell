#!/bin/sh
#executed from ~/.xinitrc

_TITLE_=freememappletwrapper
_VERSION_=1.0omega
_COMMENT_="CLI to start freememapplet(s) in taskbar."

MY_SELF="$0"
MY_PID=$$

test -f /etc/rc.d/f4puppy5 && {
 set +e
 source /etc/rc.d/f4puppy5 && {
 set +n
 source /etc/rc.d/f4puppy5; } || echo "WARNING : Could not source /etc/rc.d/f4puyppy5 ."

ADD_PARAMETER_LIST=
ADD_PARAMETERS=
_provide_basic_parameters

TWO_HELP=''; TWO_VERSION=''; TWO_VERBOSE=''; TWO_DEBUG=''; ## Set to anything if code requires further down (ie. custom usage or version message)
ADD_HELP_MSG="$_COMMENT_"
_parse_basic_parameters "$@"
[ "$DO_SHIFT" ] && [ ! "${DO_SHIFT//[[:digit:]]/}" ] && {
for i in `seq 1 1 $DO_SHIFT`; do shift; done; }

_trap
} || echo "Warning : No /etc/rc.d/f4puppy5 installed."


ERR=/dev/null

. /etc/rc.d/PUPSTATE

echo "PUPMODE=$PUPMODE'"

#note, could also have -u <delay> for update time...
for p in `echo -e "${PATH//:/\n}"` ; do
 FREEMEMAPPLETS="$FREEMEMAPPLETS
 `ls -1F ${p}/freememapplet* 2>$ERR |grep '\*$' |tr -d '\*'`"
done

FREEMEMAPPLETS=`echo "$FREEMEMAPPLETS" | grep -v "${0##*/}"`

for app in $FREEMEMAPPLETS ; do
echo "'${0}' : '$app'"
#pidof $app || $app -p $PUPMODE &
case $app in
*applet-xlib-0.1.2) killall -9 ${app##*/};;
*)  pidof ${app##*/} && continue;;
esac
true
case $app in
*applet1) false;; #Segmentation fault
*applet-1.0) exec $app -u 4 &
;;      #-u <seconds>, --upadte <seconds>: Set update interval (default 15) -h, --help, -v, --version:        Display this help text and exit
*applet-1.2.1-gtk-1) false;; #libgtk-1.2.so.0: cannot open shared object file: No such
*applet-1.2.2.1) exec $app -u 7 &
;;  #-u <seconds>, --upadte <seconds>: Set update interval (default 15) -h, --help, -v, --version:        Display this help text and exit
*applet-1.2.2-gtk-1) false;; #libgtk-1.2.so.0: cannot open shared object file: No such
*applet-2.2-3) exec $app &
;;        #*applet1
*appletdelayed) false;;      #/usr/sbin/freememappletdelayed: line 4: exec: freememapplet: not found
*applet-xlib-0.1.2) exec $app -p $PUPMODE &
;; #-d <disp> Set the display -p <PUPMODE> PUPMODE variable value -h, --help   Display this help text and exit -u <seconds> Set update interval (default 10)
*applet-xlib-404)   #exec $app -p $PUPMODE &
false #HIGH CPU usage
;;
*applet-xlib-404-2) #exec $app -p $PUPMODE &
false #HIGH CPU usage
;;
*appletshell) false;;
*applet_tray) exec $app &
;;
esac

echo
sleep 1
done

#exec freememapplet -p $PUPMODE
# Very End of this file 'usr/sbin/freememappletshell' #
###END###

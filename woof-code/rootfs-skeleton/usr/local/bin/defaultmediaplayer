#!/bin/sh
#
# New header by Karl Reimer Godt, September 2014
  _TITLE_="Puppy_defaultmediaplayer"
_VERSION_=1.0omega
_COMMENT_="$_TITLE_:Puppy Linux shell script [to TODO here]"

MY_SELF="/usr/local/bin/defaultmediaplayer"
MY_PID=$$

test -f /etc/rc.d/f4puppy5 && {
[ "$HAVE_F4PUPPY5" ] || source /etc/rc.d/f4puppy5

ADD_PARAMETER_LIST=""
ADD_PARAMETERS=""
_provide_basic_parameters

TWO_HELP=''; TWO_VERSION=''; TWO_VERBOSE=''; TWO_DEBUG=''; ## Set to anything if code requires further down (ie. custom usage or version message)
ADD_HELP_MSG="$_COMMENT_"
_parse_basic_parameters "$@"
[ "$DO_SHIFT" ] && [ ! "${DO_SHIFT//[[:digit:]]/}" ] && {
  for oneSHIFT in `seq 1 1 $DO_SHIFT`; do shift; done; }

_trap

}
# End new header
#


echo "
`date`
$0: '$@'
" >> /tmp/media.log
set | grep BASH_ARG >> /tmp/media.log


#for c in `seq $(echo "${BASH_ARGC[0]}") -1 1`;do
#vc=$((c-1));((C++))
#P[$C]=`echo "${BASH_ARGV[$vc]}"`
#done

LIST=`set |grep BASH_ARGV |sed 's#BASH_ARGV=(##;s#" \(\[[0-9*]\]="\)#"\n\1#g;s#)$##'`
echo "$LIST" >> /tmp/media.log
#while read line;do
#echo "$line"
#line="param$line"
#eval $line
#done <<EOL
#$(echo "$LIST")
#EOL

while read line;
do
echo "$line"
echo "$line" >> /tmp/media.log
line=`echo "$line" |sed 's,.*=,,;s,"$,,;s,^",,'`
echo "$line" >> /tmp/media.log
echo "$line"

case "$line" in
*.flv|*.Flv|*.FLV|*.avi|*.AVI|*.Avi|*.swf|*.Swf|*.SWF)
exec gnome-mplayer "$@"
;;
*.mp4)
exec vlc "$@"
;;
*.mkv) #matroska container
exec gmplayer -vo x11 "$@"
;;
*)
if test -f "$line"; then
FILE_FORMAT=`file "$line"`
fi
echo "FILE_FORMAT='$FILE_FORMAT'" >&2
    case "$FILE_FORMAT" in
    *MPEG*v4*) exec vlc "$@" ;;
    *Flash*) exec gnome-mplayer "$@" ;;
    esac

exec gxineshell "$@"
;;
esac

done <<EOI
$(echo "$LIST")
EOI
# Very End of this file 'usr/local/bin/defaultmediaplayer' #
###END###

#!/bin/bash


echo "
`date`
$0: '$@'
" >> /tmp/media.log
set | grep BASH_ARG >> /tmp/media.log


#for c in `seq $(echo "${BASH_ARGC[0]}") -1 1`;do
#vc=$((c-1));((C++))
#P[$C]=`echo "${BASH_ARGV[$vc]}"`
#done

LIST=`set |grep BASH_ARGV |sed 's#BASH_ARGV=(##;s#" \(\[[0-9*]\]="\)#"\n\1#g;s#)$##'`
echo "$LIST" >> /tmp/media.log
#while read line;do
#echo "$line"
#line="param$line"
#eval $line
#done <<EOL
#$(echo "$LIST")
#EOL

while read line;
do
echo "$line"
echo "$line" >> /tmp/media.log
line=`echo "$line" |sed 's,.*=,,;s,"$,,;s,^",,'`
echo "$line" >> /tmp/media.log
echo "$line"

case "$line" in
*.flv|*.Flv|*.FLV|*.avi|*.AVI|*.Avi|*.swf|*.Swf|*.SWF)
exec gnome-mplayer "$@"
;;
*.mp4)
exec vlc "$@"
;;
*.mkv) #matroska container
exec gmplayer "$@"
;;
*)
if test -f "$line"; then
FILE_FORMAT=`file "$line"`
fi
echo "FILE_FORMAT='$FILE_FORMAT'" >&2
    case "$FILE_FORMAT" in
    *MPEG*v4*) exec vlc "$@" ;;
    *Flash*) exec gnome-mplayer "$@" ;;
    esac

exec gxineshell "$@"
;;
esac

done <<EOI
$(echo "$LIST")
EOI

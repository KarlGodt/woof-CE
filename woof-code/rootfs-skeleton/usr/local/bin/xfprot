#!/bin/sh
#
# New header by Karl Reimer Godt, September 2014
  _TITLE_="Puppy_xfprot"
_VERSION_=1.0omega
_COMMENT_="$_TITLE_:Puppy Linux shell script [to TODO here]"

MY_SELF="/usr/local/bin/xfprot"
MY_PID=$$

test -f /etc/rc.d/f4puppy5 && {
source /etc/rc.d/f4puppy5

ADD_PARAMETER_LIST=""
ADD_PARAMETERS=""
_provide_basic_parameters

TWO_HELP=''; TWO_VERSION=''; TWO_VERBOSE=''; TWO_DEBUG=''; ## Set to anything if code requires further down (ie. custom usage or version message)
ADD_HELP_MSG="$_COMMENT_"
_parse_basic_parameters "$@"
[ "$DO_SHIFT" ] && [ ! "${DO_SHIFT//[[:digit:]]/}" ] && {
  for oneSHIFT in `seq 1 1 $DO_SHIFT`; do shift; done; }

_trap

}
# End new header
#
#v406 bugfix.

if [ ! -f /usr/local/f-prot/fpscan ];then
 xmessage -bg red "ALERT: f-prot not installed.
You need to be connected to the Internet, click OK button and an attempt will
be made to download f-prot from http://files.f-prot.com/download/home_user/.
It will then be installed to /usr/local/f-prot. Note that the download file
is about 14MB. Note, f-prot has the 'antivir.def' signature file required
by Xfprot. Click the close-box on this window to abort."
 [ $? -ne 0 ] && exit #v406
 cd /usr/local
 #rm -f /usr/local/fp-Linux-i686-ws.tar.gz #precaution.
 xterm -e wget http://files.f-prot.com/files/unix-trial/fp-Linux-i686-ws.tar.gz
 sync
 tar -zxf fp-Linux-i686-ws.tar.gz
 sync
 rm -f fp-Linux-i686-ws.tar.gz
 if [ ! -f f-prot/install-f-prot.pl ];then
  xmessage "ERROR: error expanding fp-Linux-i686-ws.tar.gz. Aborting."
  exit
 fi
 cd f-prot
 xterm -e ./install-f-prot.pl
else
 [ ! -f /usr/local/f-prot/antivir.def ] && xmessage "ALERT: The virus signature file /usr/local/f-prot/antivir.def is missing
(approx. 28MB). Click 'Update' button to download it. Note, if 'licence.key'
is reported to be invalid, you will need to download the complete 'f-prot' package form the vendors at http://www.f-prot.com/download/home_user/" &
fi

exec /usr/local/xfprot/xfprot-gtk

#!/bin/bash
#Clock Set Gui 
#Robert Lane 2009 (tasmod)

AFRICA="africa.pool.ntp.org"
ASIA="asia.pool.ntp.org" 
EUROPE="europe.pool.ntp.org" 
NORTHAMERICA="north-america.pool.ntp.org " 
SOUTHAMERICA="south-america.pool.ntp.org " 
OCEANIA="oceania.pool.ntp.org" 
UK="uk.pool.ntp.org" 

case "$1" in
AFRICA)
Xdialog --infobox "Setting Time ........Please wait" 12 40 &
           ntpdate  $AFRICA > /tmp/settertime
           hwclock -w
NEWCURRENT_TIME=`date +%c`
offset=`cat /tmp/settertime | grep 'offset' | cut -d 't' -f 6`
;;
ASIA)
Xdialog --infobox "Setting Time ........Please wait" 12 40 &
          ntpdate $ASIA > /tmp/settertime
	      hwclock -w
NEWCURRENT_TIME=`date +%c`
offset=`cat /tmp/settertime | grep 'offset' | cut -d 't' -f 6`
;;
EUROPE)
Xdialog --infobox "Setting Time ........Please wait" 12 40 &
         ntpdate $EUROPE > /tmp/settertime
         hwclock -w
NEWCURRENT_TIME=`date +%c`
offset=`cat /tmp/settertime | grep 'offset' | cut -d 't' -f 6`
;;
NORTHAMERICA)
Xdialog --infobox "Setting Time ........Please wait" 12 40 &
         ntpdate  $NORTHAMERICA > /tmp/settertime
         hwclock -w
NEWCURRENT_TIME=`date +%c`
offset=`cat /tmp/settertime | grep 'offset' | cut -d 't' -f 6`
;;
SOUTHAMERICA)
Xdialog --infobox "Setting Time ........Please wait" 12 40 &
         ntpdate  $SOUTHAMERICA > /tmp/settertime
	     hwclock -w
NEWCURRENT_TIME=`date +%c`
offset=`cat /tmp/settertime | grep 'offset' | cut -d 't' -f 6`
;;
OCEANIA)
Xdialog --infobox "Setting Time ........Please wait" 12 40 &
        ntpdate $OCEANIA > /tmp/settertime
    	hwclock -w
NEWCURRENT_TIME=`date +%c`
offset=`cat /tmp/settertime | grep 'offset' | cut -d 't' -f 6`
;;
UK)
Xdialog --infobox "Setting Time ........Please wait" 12 40 &
         ntpdate  $UK > /tmp/settertime
		 hwclock -w   
NEWCURRENT_TIME=`date +%c`
offset=`cat /tmp/settertime |grep 'offset' | cut -d 't' -f 6`
;;
esac


   	
cd $HOME
export timeis="
<window title=\"Synchronised Time\">
 <vbox>
   <frame Updated Time>
   	<text use-markup=\"true\"><label>\"<b>$NEWCURRENT_TIME</b>\"</label></text>
	<text><label>\"       \"</label></text>
	<text use-markup=\"true\"><label>\" <b>  Offset was $offset      </b>\"</label></text>
	</frame>
   <frame>
   <button>
    <input file icon=\"gtk-cancel\"></input>
    <label>Close</label>
   </button>
   </frame>
    </vbox>
</window>"

#execute gtkdialog
gtkdialog3  -p timeis 




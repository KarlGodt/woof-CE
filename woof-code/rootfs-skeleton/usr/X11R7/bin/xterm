#!/bin/ash
#rxvt does not understand the '-hold' option.
. /etc/rc.d/f4puppy5

which rxvt >>$OUT || _exit 3 "rxvt binary not installed in PATH.
Where can it be ?"

SIM_FILE=/tmp/xterm_simulate_hold.sh.$$

if [ "`echo "${*}" | grep -e '-hold'`" ]; then
 EXECCOMMAND=`echo "${*}" | grep -o -e ' -e .*' | sed 's/ -e //'`

 if [ "$EXECCOMMAND" ]; then
  _debug "EXECCOMMAND='$EXECCOMMAND'"

  #while :; do
  (
  echo '#!/bin/sh'
  echo "export PATH=$PATH:."
  #) >"$SIM_FILE"

 if test "$DEBUG"; then
 #(
  echo "echo \"This is $SIM_FILE\""
  echo "echo \"Will run command $EXECCOMMAND\""
  #)>> "$SIM_FILE"
 fi

  #(
  echo "$EXECCOMMAND"
  echo 'echo $? >'"$SIM_FILE".rv
  echo 'echo'
  echo 'echo -n "FINISHED. PRESS ENTER KEY TO CLOSE THIS WINDOW: "'
  echo 'read simulation_done'
  #)  >> "$SIM_FILE"
  ) > "$SIM_FILE"
  #break
  #done > "$SIM_FILE"

  chmod $VERB +x "$SIM_FILE"
  rxvt -e "$SIM_FILE"

  [ "$DEBUG" ] || rm $VERB -f "$SIM_FILE"

  test -s "$SIM_FILE".rv && read RV <"$SIM_FILE".rv
  rm $VERB -f "$SIM_FILE".rv
  exit $RV
 fi
fi

exec rxvt "${@}"

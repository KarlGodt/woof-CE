#!/bin/sh
#LGPL 2007 www.puppylinux.com
# Replaces test-scsi in Antonio Gallo's libhardware package.
# Written by Dougal. Small mods by BarryK 19 June 2007.

test -f /etc/rc.d/f4puppy5 && {
[ "$HAVE_F4PUPPY5" ] || source /etc/rc.d/f4puppy5

ADD_PARAMETER_LIST=""
ADD_PARAMETERS=""
_provide_basic_parameters

TWO_HELP=''; TWO_VERSION=''; TWO_VERBOSE=''; TWO_DEBUG=''; ## Set to anything if code requires further down (ie. custom usage or version message)
ADD_HELP_MSG=""
_parse_basic_parameters "$@"
[ "$DO_SHIFT" ] && [ ! "${DO_SHIFT//[[:digit:]]/}" ] && {
    for i in `seq 1 1 $DO_SHIFT`; do shift; done; }
_trap
}

for ADEV in `ls -1 /sys/block | grep -E 'sd[a-z]|sr[0-9]|scd[0-9]' | tr '\n' ' '`
do
  [ "$ADEV" ] || continue
  #echo "$ADEV"
  case $ADEV in
   sd*) # all appear as Direct-Access
     MEDIA="Direct-Access" ;;
   sr*|scd*) #  scsi cdroms #(note that original apps use 'CD-ROM' to
        #+ distinguish from ide cdroms, but it just seems to cause trouble)
     MEDIA="cdrom" ;;
   *) # maybe I let something bad in -- skip it
     continue
     ;;
  esac
  VENDOR="`cat /sys/block/$ADEV/device/vendor`"
  MODEL="`cat /sys/block/$ADEV/device/model`"
  echo "/dev/$ADEV - $MEDIA - $VENDOR$MODEL"
done

#!/bin/sh

test -f /etc/rc.d/f4puppy5 && {
[ "$HAVE_F4PUPPY5" ] || source /etc/rc.d/f4puppy5

ADD_PARAMETER_LIST=""
ADD_PARAMETERS=""
_provide_basic_parameters

TWO_HELP=''; TWO_VERSION=''; TWO_VERBOSE=''; TWO_DEBUG=''; ## Set to anything if code requires further down (ie. custom usage or version message)
ADD_HELP_MSG=""
_parse_basic_parameters "$@"
[ "$DO_SHIFT" ] && [ ! "${DO_SHIFT//[[:digit:]]/}" ] && {
    for i in `seq 1 1 $DO_SHIFT`; do shift; done; }
_trap
}

LOGFILE="$1"
BUTTONTEXT="$2" #ex: Cancel
X_POS=$3
Y_POS=$4
WIDTHPIXELS=$5
HEIGHTPIXELS=$6
TITLE="$7"

WIDTHCHARS=`expr $WIDTHPIXELS \/ 7`
HEIGHTCHARS=`expr $HEIGHTPIXELS \/ 8`

#mono text for log box...
echo 'style "specialmono"
{
  font_name="Mono 13"
}

class "GtkText*" style "specialmono"' > /tmp/gtkrc_mono
export GTK2_RC_FILES=/tmp/gtkrc_mono:/root/.gtkrc-2.0

XDIALOG=`which Xdialog`
ln -snf $XDIALOG /tmp/gtklogfileviewer #hack so pburn will kill it.

# REM: Xdialog tailbox
/tmp/gtklogfileviewer --title "$TITLE" --buttons-style text --fixed-font --no-ok --cancel-label "$BUTTONTEXT" --begin $X_POS $Y_POS --tailbox "$LOGFILE" $HEIGHTCHARS $WIDTHCHARS > /dev/null 2>&1
RETVAL=$?

if [ $RETVAL -eq 1 ];then
 echo 'exitbutton'
else
 echo 'windowclosed'
fi

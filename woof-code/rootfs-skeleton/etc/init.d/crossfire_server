#!/bin/sh

export PS_PERSONALITY=debian  #digital

case "$1" in
stop)
## Several ways to catch the PID, Adjust to your current system.
##pid_of_crossfire_server=`/bin/ps-FULL -o %PID | grep -E 'crossfire*|crossfire[-_]server*' | grep -v grep |awk '{print $1}'`
pid_of_crossfire_server=`/bin/ps-FULL --no-heading -C crossfire |awk '{print $1}'`

echo "$pid_of_crossfire_server"

for each_pid in ${pid_of_crossfire_server} ; do
kill -s HUP $each_pid
sleep 2s
ps -p $each_pid && kill -s ILL $each_pid
done

;;

status)
/bin/ps-FULL --no-heading -C crossfire && echo -e "\n Running." || echo -e "\n Crossfire Server Not Running."
;;

help|-h|-help|--help)
echo "'`readlink -e $0`' stop|help
only avalable parameters.
To start the server, you would need to
add a 'start' parameter to this script
or run it from any other terminal.
Purpose is mainly to stop the server(s) at shutdown,
so the rootpartition can be remounted readonly at the very end."

;;

*) :;;
esac
exit $?

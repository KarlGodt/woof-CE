#!/bin/ash

/bin/logger -t "acpid:$0" -p 1 "Started"

echo -n "pidof X:"
if pidof X
then

if pidof pppd;
then
kill -s HUP `pidof pppd`
sleep 2
pidof pppd && /bin/logger -t "acpid:$0" -p 1 "Failed to kill pppd."
else
killall pgprs-connect
sleep 2
export DISPLAY=':0'
rxvt -e pgprs-connect
fi

else
if pidof pppd;
then
kill -s HUP `pidof pppd`
sleep 2
pidof pppd && /bin/logger -t "acpid:$0" -p 1 "Failed to kill pppd."
else
pgprs-connect
fi

fi
/bin/logger -t "acpid:$0" -p 1 "Ended"

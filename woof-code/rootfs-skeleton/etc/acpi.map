
#static void parse_map_file(const char *filename)
#{
#   parser_t *parser;
#   char *tokens[6];
#
#   parser = config_open2(filename, fopen_for_read);
#
#   if (parser) {
#       while (config_read(parser, tokens, 6, 6, "# \t", PARSE_NORMAL)) {
#           evt_tab = xrealloc_vector(evt_tab, 1, n_evt);
#           evt_tab[n_evt].s_type = xstrdup(tokens[0]);
#           evt_tab[n_evt].n_type = xstrtou(tokens[1], 16);
#           evt_tab[n_evt].s_code = xstrdup(tokens[2]);
#           evt_tab[n_evt].n_code = xatou16(tokens[3]);
#           evt_tab[n_evt].value = xatoi_positive(tokens[4]);
#           evt_tab[n_evt].desc = xstrdup(tokens[5]);
#           n_evt++;
#       }
#       config_close(parser);
#   } else {
#       evt_tab = (void*)f_evt_tab;
#       n_evt = ARRAY_SIZE(f_evt_tab);
#   }
#}
#struct acpi_event {
#   const char *s_type;
#   uint16_t n_type;
#   const char *s_code;
#   uint16_t n_code;
#   uint32_t value;
#   const char *desc;
#};
#
#static const struct acpi_event f_evt_tab[] = {
#   { "EV_KEY", 0x01, "KEY_POWER", 116, 1, "button/power PWRF 00000080" },
#   { "EV_KEY", 0x01, "KEY_POWER", 116, 1, "button/power PWRB 00000080" },
#};
#   116     0xfe08 (ISO_Next_Group)


#static const char *find_action(struct input_event *ev, const char *buf)
#{
#   const char *action = NULL;
#   int i;
#
#   // map event
#   for (i = 0; i < n_evt; i++) {
#       if (ev) {
#           if (ev->type == evt_tab[i].n_type && ev->code == evt_tab[i].n_code && ev->value == evt_tab[i].value) {
#               action = evt_tab[i].desc;
#               break;
#           }
#       }
#
#       if (buf) {
#           if (strncmp(buf, evt_tab[i].desc, strlen(buf)) == 0) {
#               action = evt_tab[i].desc;
#               break;
#           }
#       }
#   }
#
#   // get action
#   if (action) {
#       for (i = 0; i < n_act; i++) {
#           if (strstr(action, act_tab[i].key)) {
#               action = act_tab[i].action;
#               break;
#           }
#       }
#   }
#
#   return action;
#}

#if (option_mask32 & OPT_e) {
#           event = NULL;
#           if (option_mask32 & OPT_e) {
#               char *buf;
#               int len;
#
#               buf = xmalloc_reads(pfd[i].fd, NULL);
#               /* buf = "button/power PWRB 00000080 00000000" */
#               len = strlen(buf) - 9;
#               if (len >= 0)
#                   buf[len] = '\0';
#               event = find_action(NULL, buf);
#               free(buf);

## bash-3.00# cat /proc/acpi/event
## button/power PWRF 00000080 00000005

EV_KEY 0x01 KEY_POWER 116 1 button/power PWRF 00000080

#./keyboard/actions/116: ''
#UNHANDLED KEY_POWER

EV_KEY 0x01 KEY_POWER 116 1 KEY_POWER

#} else {
#               struct input_event ev;
#
#               if (sizeof(ev) != full_read(pfd[i].fd, &ev, sizeof(ev)))
#                   continue;
#
#               if (ev.value != 1 && ev.value != 0)
#                   continue;
#
#               event = find_action(&ev, NULL);

EV_KEY 0x01 KEY_MUTE        113  1 "MUTE"
EV_KEY 0x01 KEY_VOLUMEDOWN      114  1 "VOLUMEDOWN"
EV_KEY 0x01 KEY_VOLUMEUP        115  1 "VOLUMEUP"
#EV_KEY 0x01 KEY_POWER       116  1 "POWER"
EV_KEY 0x01 KEY_KPEQUAL     117  1 "KPEQUAL"
EV_KEY 0x01 KEY_KPPLUSMINUS     118  1 "KPPLUSMINUS"
EV_KEY 0x01 KEY_PAUSE       119  1 "PAUSE"
EV_KEY 0x01 KEY_SCALE       120  1 "SCALE"
EV_KEY 0x01 KEY_KPCOMMA     121  1 "KPCOMMA"
EV_KEY 0x01 KEY_HANGEUL     122  1 "HANGEUL"
EV_KEY 0x01 KEY_HANJA       123  1 "HANJA"
EV_KEY 0x01 KEY_YEN     124  1 "YEN"
EV_KEY 0x01 KEY_LEFTMETA        125  1 "LEFTMETA"
EV_KEY 0x01 KEY_RIGHTMETA       126  1 "RIGHTMETA"
EV_KEY 0x01 KEY_COMPOSE     127  1 "COMPOSE"
EV_KEY 0x01 KEY_STOP        128  1 "STOP"
EV_KEY 0x01 KEY_AGAIN       129  1 "AGAIN"
EV_KEY 0x01 KEY_PROPS       130  1 "PROPS"
EV_KEY 0x01 KEY_UNDO        131  1 "UNDO"
EV_KEY 0x01 KEY_FRONT       132  1 "FRONT"
EV_KEY 0x01 KEY_COPY        133  1 "COPY"
EV_KEY 0x01 KEY_OPEN        134  1 "OPEN"
EV_KEY 0x01 KEY_PASTE       135  1 "PASTE"
EV_KEY 0x01 KEY_FIND        136  1 "FIND"
EV_KEY 0x01 KEY_CUT     137  1 "CUT"
EV_KEY 0x01 KEY_HELP        138  1 "HELP"
EV_KEY 0x01 KEY_MENU        139  1 "MENU"
EV_KEY 0x01 KEY_CALC        140  1 "CALC"
EV_KEY 0x01 KEY_SETUP       141  1 "SETUP"
EV_KEY 0x01 KEY_SLEEP       142  1 "SLEEP"
EV_KEY 0x01 KEY_WAKEUP      143  1 "WAKEUP"
EV_KEY 0x01 KEY_FILE        144  1 "FILE"
EV_KEY 0x01 KEY_SENDFILE        145  1 "SENDFILE"
EV_KEY 0x01 KEY_DELETEFILE      146  1 "DELETEFILE"
EV_KEY 0x01 KEY_XFER        147  1 "XFER"
EV_KEY 0x01 KEY_PROG1       148  1 "PROG1"
EV_KEY 0x01 KEY_PROG2       149  1 "PROG2"
EV_KEY 0x01 KEY_WWW     150  1 "WWW"
EV_KEY 0x01 KEY_MSDOS       151  1 "MSDOS"
EV_KEY 0x01 KEY_COFFEE      152  1 "COFFEE"
EV_KEY 0x01 KEY_DIRECTION       153  1 "DIRECTION"
EV_KEY 0x01 KEY_CYCLEWINDOWS        154  1 "CYCLEWINDOWS"
EV_KEY 0x01 KEY_MAIL        155  1 "MAIL"
EV_KEY 0x01 KEY_BOOKMARKS       156  1 "BOOKMARKS"
EV_KEY 0x01 KEY_COMPUTER        157  1 "COMPUTER"
EV_KEY 0x01 KEY_BACK        158  1 "BACK"
EV_KEY 0x01 KEY_FORWARD     159  1 "FORWARD"
EV_KEY 0x01 KEY_CLOSECD     160  1 "CLOSECD"
EV_KEY 0x01 KEY_EJECTCD     161  1 "EJECTCD"
EV_KEY 0x01 KEY_EJECTCLOSECD        162  1 "EJECTCLOSECD"
EV_KEY 0x01 KEY_NEXTSONG        163  1 "NEXTSONG"
EV_KEY 0x01 KEY_PLAYPAUSE       164  1 "PLAYPAUSE"
EV_KEY 0x01 KEY_PREVIOUSSONG        165  1 "PREVIOUSSONG"
EV_KEY 0x01 KEY_STOPCD      166  1 "STOPCD"
EV_KEY 0x01 KEY_RECORD      167  1 "RECORD"
EV_KEY 0x01 KEY_REWIND      168  1 "REWIND"
EV_KEY 0x01 KEY_PHONE       169  1 "PHONE"
EV_KEY 0x01 KEY_ISO     170  1 "ISO"
EV_KEY 0x01 KEY_CONFIG      171  1 "CONFIG"
EV_KEY 0x01 KEY_HOMEPAGE        172  1 "HOMEPAGE"
EV_KEY 0x01 KEY_REFRESH     173  1 "REFRESH"
EV_KEY 0x01 KEY_EXIT        174  1 "EXIT"
EV_KEY 0x01 KEY_MOVE        175  1 "MOVE"
EV_KEY 0x01 KEY_EDIT        176  1 "EDIT"
EV_KEY 0x01 KEY_SCROLLUP        177  1 "SCROLLUP"
EV_KEY 0x01 KEY_SCROLLDOWN      178  1 "SCROLLDOWN"
EV_KEY 0x01 KEY_KPLEFTPAREN     179  1 "KPLEFTPAREN"
EV_KEY 0x01 KEY_KPRIGHTPAREN        180  1 "KPRIGHTPAREN"
EV_KEY 0x01 KEY_NEW     181  1 "NEW"
EV_KEY 0x01 KEY_REDO        182  1 "REDO"
EV_KEY 0x01 KEY_F13     183  1 "F13"
EV_KEY 0x01 KEY_F14     184  1 "F14"
EV_KEY 0x01 KEY_F15     185  1 "F15"
EV_KEY 0x01 KEY_F16     186  1 "F16"
EV_KEY 0x01 KEY_F17     187  1 "F17"
EV_KEY 0x01 KEY_F18     188  1 "F18"
EV_KEY 0x01 KEY_F19     189  1 "F19"
EV_KEY 0x01 KEY_F20     190  1 "F20"
EV_KEY 0x01 KEY_F21     191  1 "F21"
EV_KEY 0x01 KEY_F22     192  1 "F22"
EV_KEY 0x01 KEY_F23     193  1 "F23"
EV_KEY 0x01 KEY_F24     194  1 "F24"
EV_KEY 0x01 KEY_PLAYCD      200  1 "PLAYCD"
EV_KEY 0x01 KEY_PAUSECD     201  1 "PAUSECD"
EV_KEY 0x01 KEY_PROG3       202  1 "PROG3"
EV_KEY 0x01 KEY_PROG4       203  1 "PROG4"
EV_KEY 0x01 KEY_DASHBOARD       204  1 "DASHBOARD"
EV_KEY 0x01 KEY_SUSPEND     205  1 "SUSPEND"
EV_KEY 0x01 KEY_CLOSE       206  1 "CLOSE"
EV_KEY 0x01 KEY_PLAY        207  1 "PLAY"
EV_KEY 0x01 KEY_FASTFORWARD     208  1 "FASTFORWARD"
EV_KEY 0x01 KEY_BASSBOOST       209  1 "BASSBOOST"
EV_KEY 0x01 KEY_PRINT       210  1 "PRINT"
EV_KEY 0x01 KEY_HP      211  1 "HP"
EV_KEY 0x01 KEY_CAMERA      212  1 "CAMERA"
EV_KEY 0x01 KEY_SOUND       213  1 "SOUND"
EV_KEY 0x01 KEY_QUESTION        214  1 "QUESTION"
EV_KEY 0x01 KEY_EMAIL       215  1 "EMAIL"
EV_KEY 0x01 KEY_CHAT        216  1 "CHAT"
EV_KEY 0x01 KEY_SEARCH      217  1 "SEARCH"
EV_KEY 0x01 KEY_CONNECT     218  1 "CONNECT"
EV_KEY 0x01 KEY_FINANCE     219  1 "FINANCE"
EV_KEY 0x01 KEY_SPORT       220  1 "SPORT"
EV_KEY 0x01 KEY_SHOP        221  1 "SHOP"
EV_KEY 0x01 KEY_ALTERASE        222  1 "ALTERASE"
EV_KEY 0x01 KEY_CANCEL      223  1 "CANCEL"
EV_KEY 0x01 KEY_BRIGHTNESSDOWN      224  1 "BRIGHTNESSDOWN"
EV_KEY 0x01 KEY_BRIGHTNESSUP        225  1 "BRIGHTNESSUP"
EV_KEY 0x01 KEY_MEDIA       226  1 "MEDIA"
EV_KEY 0x01 KEY_SWITCHVIDEOMODE     227  1 "SWITCHVIDEOMODE"
EV_KEY 0x01 KEY_KBDILLUMTOGGLE      228  1 "KBDILLUMTOGGLE"
EV_KEY 0x01 KEY_KBDILLUMDOWN        229  1 "KBDILLUMDOWN"
EV_KEY 0x01 KEY_KBDILLUMUP      230  1 "KBDILLUMUP"
EV_KEY 0x01 KEY_SEND        231  1 "SEND"
EV_KEY 0x01 KEY_REPLY       232  1 "REPLY"
EV_KEY 0x01 KEY_FORWARDMAIL     233  1 "FORWARDMAIL"
EV_KEY 0x01 KEY_SAVE        234  1 "SAVE"
EV_KEY 0x01 KEY_DOCUMENTS       235  1 "DOCUMENTS"
EV_KEY 0x01 KEY_BATTERY     236  1 "BATTERY"
EV_KEY 0x01 KEY_BLUETOOTH       237  1 "BLUETOOTH"
EV_KEY 0x01 KEY_WLAN        238  1 "WLAN"
EV_KEY 0x01 KEY_UWB     239  1 "UWB"
EV_KEY 0x01 KEY_UNKNOWN     240  1 "UNKNOWN"
EV_KEY 0x01 KEY_VIDEO_NEXT      241  1 "VIDEO_NEXT"
EV_KEY 0x01 KEY_VIDEO_PREV      242  1 "VIDEO_PREV"
EV_KEY 0x01 KEY_BRIGHTNESS_CYCLE        243  1 "BRIGHTNESS_CYCLE"
EV_KEY 0x01 KEY_BRIGHTNESS_ZERO     244  1 "BRIGHTNESS_ZERO"
EV_KEY 0x01 KEY_DISPLAY_OFF     245  1 "DISPLAY_OFF"
EV_KEY 0x01 KEY_WIMAX       246  1 "WIMAX"
EV_KEY 0x01 KEY_RFKILL      247  1 "RFKILL"
EV_KEY 0x01 KEY_MICMUTE     248  1 "MICMUTE"


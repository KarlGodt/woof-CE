#!/bin/bash

[ "$1" ] || { echo "Need parameter ie 'usb'";exit 1; }

for p in $@ ; do

if [ "$grepP" ] ; then
grepP="${grepP}|$p"
else
grepP="$p"
fi

done

[ "$grepP" ] || exit 1

modprobe -l | grep -E "$grepP" | while read module ; do
mod=${module##*/}
module=${mod//\.ko/}
modprobe -v $module >&2
sleep 1
done

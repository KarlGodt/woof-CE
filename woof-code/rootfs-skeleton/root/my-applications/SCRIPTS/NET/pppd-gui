#!/bin/sh

#********
#
#********

peersfile=/etc/ppp/peers/gprsmm

VALUES=`grep '^\.B' /root/pppd.8 |awk '{print $2}' | tr -d '\\' |sort -d |grep -vE '^[A-Z]|^~|^/|\.txt|^[0-9]'`


for v in $VALUES ; do

if ! grep -E "^#*$v|^$v" $peersfile ;then
echo "#$v" >> $peersfile
fi

done

rm -f /tmp/pppd_gui*
GUI_VARs=`grep -E '^#[a-z].*|^[a-z].*' $peersfile |awk '{print $1}'`

for v in $GUI_VARs ; do
V=`echo $v |tr '[[:lower:]]' '[[:upper:]]'`
case $v in
\#*) echo "$V $v off" >>/tmp/pppd_gui.off;;
#echo "$v off" >>/tmp/pppd_gui.off;;
*) echo "$V $v on" >> /tmp/pppd_gui.on;;
#echo "$v on" >> /tmp/pppd_gui.on;;
esac
done

cat /tmp/pppd_gui.off |tr '\n' ' ' >/tmp/pppd_gui.Xdialog.list
cat /tmp/pppd_gui.on |tr '\n' ' ' >>/tmp/pppd_gui.Xdialog.list
sed -i 's|\n| |' /tmp/pppd_gui.Xdialog.list
XDIALOG_VARS=`cat /tmp/pppd_gui.Xdialog.list`
echo $XDIALOG_VARS

#Xdialog --title "pppd_gui" --2inputsbox "Off and On list" 0 0 $XDIALOG_VARS
Xdialog --title "pppd_gui" --buildlist "Off and On list" 30 50 0 $XDIALOG_VARS





#!/bin/sh 

# this script was adapted for Puppy 2.12 by EdB, from the original in 
# http://www.linux.com/article.pl?sid=06/05/24/1716222 

# discover video card's ID 
#ID=`lspci -i /usr/share/pci-usb-pcmcia.ids | grep VGA | awk '{ print $1 }' | sed -e 's@0000:@@' -e 's@:@/@'` 

# securely create a temporary file 
#TMP_FILE=`mktemp /var/tmp/video_state.XXXXXX` 
# trap 'rm -f $TMP_FILE' 0 1 15 

# switch to virtual terminal 2 to avoid graphics 

########################################################################
#
#
#
#
#
# /dev/hda7
# /dev/hda7:
# LABEL="/"
# UUID="429ee1ed-70a4-43a5-89f8-33496c489260"
# TYPE="ext4"
# DISTRO_NAME='LucidÂPuppy'
# DISTRO_VERSION=218
# DISTRO_MINOR_VERSION=00
# DISTRO_BINARY_COMPAT='ubuntu'
# DISTRO_FILE_PREFIX='luci'
# DISTRO_COMPAT_VERSION='lucid'
# DISTRO_KERNEL_PET='linux_kernel-2.6.33.2-tickless_smp_patched-L3.pet'
# PUPMODE=2
# SATADRIVES=''
# PUP_HOME='/'
# PDEV1='hda7'
# DEV1FS='ext4'
# LinuxÂpuppypcÂ2.6.31.14Â#1ÂMonÂJanÂ24Â21:03:21ÂGMT-8Â2011Âi686ÂGNU/Linux
# Xserver=/usr/bin/Xorg
# $LANG=en_US
# today=TueÂOctÂ25Â12:33:24ÂGMT+1Â2011
#
#
#
#
#
########################################################################

# corruption in X 
chvt 2 

# write all unwritten data (just in case) 
sync 

# dump current data from the video card to the 
# temporary file 
#cat /proc/bus/pci/$ID > $TMP_FILE 

# suspend 
echo -n mem > /sys/power/state 

# restore video card data from the temporary file 
# on resume 
#cat $TMP_FILE > /proc/bus/pci/$ID 

# switch back to virtual terminal 3 (running X) 
chvt 3 

# remove temporary file 
#rm -f $TMP_FILE 

# needed by my wlan internal card! 
#source /etc/rc.d/rc.network

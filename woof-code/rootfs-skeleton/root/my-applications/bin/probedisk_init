#!/bin/sh
# Karl Reimer Godt April 2013

ERR=/dev/null ##change if required

ALLDRIVES=`ls -1 /sys/block | grep -vE 'ram|loop|mtd|md'`
for drive in $ALLDRIVES ; do
[ -f /sys/block/$drive/removable ] && read REMOVABLE </sys/block/$drive/removable
case $drive in
sd*)
[ "$REMOVABLE" = 0 ] && KIND=IntSata || KIND=ExternSata ;;
sr*)
[ "$REMOVABLE" = 1 ] && KIND=CdDvd || KIND=unknown   ;;
fd*)
[ "$REMOVABLE" = 1 ] && KIND=Floppy || KIND=unknown  ;;
hd*)
[ "$REMOVABLE" = 0 ] && KIND=IntIde || KIND=IdeCd    ;;
scd*)
[ "$REMOVABLE" = 1 ] && KIND=ScsiCd || KIND=unknown   ;;
mmc*)
[ "$REMOVABLE" = 1 ] && KIND=Card || KIND=unknown   ;;
esac
[ -f /sys/block/$drive/device/vendor ] && read VEND </sys/block/$drive/device/vendor
[ -f /sys/block/$drive/device/model ] && read MODL </sys/block/$drive/device/model
[ "$VEND" ] || VEND=Unknown
[ "$MODL" ] || MODL=Unknown
PARTS=`ls -1 /sys/block/$drive/$drive[0-9]* 2>$ERR | grep -o -e '[0-9]*' |tr '\n' ' '`
echo "$drive|$KIND|$VEND $MODL|$PARTS"
done
